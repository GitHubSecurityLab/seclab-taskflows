# SPDX-FileCopyrightText: 2025 GitHub
# SPDX-License-Identifier: MIT

seclab-taskflow-agent:
  filetype: taskflow
  version: "1.0"
model_config: seclab_taskflows.configs.model_config

taskflow:
  - task:
      must_complete: true
      repeat_prompt: true
      async: true
      model: triage
      user_prompt: |
        The alert_id is {{ result.alert_id }} and the repo is {{ result.repo }}.
        The notes from the alert analysis is:        
        ```
        {{ result.result }}
        ```
        Check that the notes contain a section called "User-Controlled input" or similar.
        If the section is missing, then mark the alert as invalid and update the alert results
        with the reason saying that no user input is found.
      toolboxes:
        - seclab_taskflows.toolboxes.report_alert_state
